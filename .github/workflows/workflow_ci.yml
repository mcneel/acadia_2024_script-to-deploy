# workflow build and test the plugin. 
# This workflow is triggered on push and pull requests.

# for a list of available software on the different virtual environments, please see:
# https://github.com/actions/virtual-environments/tree/main/images

name: CI
on: [push, pull_request]

env:
  RHINO_TOKEN: ${{ secrets.RHINO_TOKEN }}

jobs:

  build:

    runs-on: windows-latest

    steps:

    - name: ğŸ›’ Checkout src
      uses: actions/checkout@v4.2.2

    - name: ğŸ¦ Install Rhino
      uses: mcneel/setup-rhino3d@v1.0.0
      id: setup_rhino
      with:
        email-address: ${{ secrets.EMAIL_ADDRESS }}

    - name: âœï¸ Add to PATH
      run: |
        "C:\Program Files\Rhino 8\System" >> $env:GITHUB_PATH

    - name: ğŸ› ï¸ Build rhproj
      id: buildproj
      run: |
        rhinocode project build D:\a\acadia_2024_script-to-deploy\acadia_2024_script-to-deploy\workflow_tools.rhproj
        Get-ChildItem D:\a\acadia_2024_script-to-deploy\acadia_2024_script-to-deploy\build\rh8
        $file=(Get-ChildItem D:\a\acadia_2024_script-to-deploy\acadia_2024_script-to-deploy\build\rh8 -Include "*.yak")
        $file.Name
        "file=$file.Name" >> $GITHUB_OUTPUT

    - name: ğŸ artifact
      uses: actions/upload-artifact@v4.4.3
      with:
        path: D:\a\acadia_2024_script-to-deploy\acadia_2024_script-to-deploy\build\rh8\workflow_tools*.yak
        name: workflow-tools